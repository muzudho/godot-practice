# きふわらべRPG で素因数分解を使う

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　きふわらべRPGで　素因数分解したいんで、素因数分解を思い出そうぜ？」  

![kifuwarabe-futsu.png](https://crieit.now.sh/upload_images/beaf94b260ae2602ca8cf7f5bbc769c261daf8686dbda.png)  
「　１人でやってくれだぜ」  

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　合成数を　素数だけで　割り切ればいいのよ」  

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👇　割るしかないの？」  

📖　[素因数分解とは？やり方を5つのステップでわかりやすく解説【例題・応用問題付き】](https://terakoya.ameba.jp/a000001447/)  

![kifuwarabe-futsu.png](https://crieit.now.sh/upload_images/beaf94b260ae2602ca8cf7f5bbc769c261daf8686dbda.png)  
「　👇　**ポラードのロー法** というのがあるらしいぜ」  

📖　[素因数分解の高速なアルゴリズム（ロー法）](https://manabitimes.jp/math/1192)  

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　分からん。割ることにする」  

# ＲＰＧの戦闘シーンのダメージ計算で使う

```plaintext
ある正の整数 n があるとする。
とりあえず n は 1～100 ぐらいを考えておく。

n を　2, 3, 5, 7　の素数で素因数分解する。

答えがいくつかあるとき、大きな数を多く使ったものを　１つ　選ぶことにする。
```

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👆　じゃあ　試しに　`n=30`　ならどうだぜ？」  

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　５×５かける……、５×３×２＝３０、　５×３×２　しかなくない？」  

![kifuwarabe-futsu.png](https://crieit.now.sh/upload_images/beaf94b260ae2602ca8cf7f5bbc769c261daf8686dbda.png)  
「　どういうアルゴリズムだぜ？」  

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　だから　割るのよ」  

# 愚直に書くと

```py
# 素因数分解の練習

print("""\
ある正の整数 n があるとする。
とりあえず n は 1～100 ぐらいを考えておく。

n を　2, 3, 5, 7　の素数で素因数分解する。

答えがいくつかあるとき、大きな数を多く使ったものを　１つ　選ぶことにする。
""")

print("Please input number:")
n = int(input())

def factorize(n):

    for a in reversed(range(1,101)):
        aa = 7 ** a

        # n 以下の小さな合成数 7a なら、とりあえず n から、それを引く
        if aa <= n:
            remain = n - aa
            print(f"(7x{a}) remain:{remain}")

            # 割り切れた
            if remain == 0:
                return [a, 0, 0, 0]

            # 余った数で続きをやる

            for b in reversed(range(1,101)):
                bb = aa * 5 ** b

                if bb <= n:
                    remain = n - bb
                    print(f"\t(7x{a} x 5x{b}) remain:{remain}")

                    # 割り切れた
                    if remain == 0:
                        return [a, b, 0, 0]

                    # 余った数で続きをやる

                    for c in reversed(range(1,101)):
                        cc = bb * 3 ** c

                        if cc <= n:
                            remain = n - cc
                            print(f"\t\t(7x{a} x 5x{b} x 3x{c}) remain:{remain}")

                            # 割り切れた
                            if remain == 0:
                                return [a, b, c, 0]

                            # 余った数で続きをやる

                            for d in reversed(range(1,101)):
                                dd = cc * 2 ** d

                                if dd <= n:
                                    remain = n - dd
                                    print(f"\t\t\t(7x{a} x 5x{b} x 3x{c} x 2x{d}) remain:{remain}")

                                    # 割り切れた
                                    if remain == 0:
                                        return [a, b, c, d]

    for b in reversed(range(1,101)):
        bb = 5 ** b

        if bb <= n:
            remain = n - bb
            print(f"(5x{b}) remain:{remain}")

            # 割り切れた
            if remain == 0:
                return [0, b, 0, 0]

            # 余った数で続きをやる

            for c in reversed(range(1,101)):
                cc = bb * 3 ** c

                if cc <= n:
                    remain = n - cc
                    print(f"\t(5x{b} x 3x{c}) remain:{remain}")

                    # 割り切れた
                    if remain == 0:
                        return [0, b, c, 0]

                    # 余った数で続きをやる

                    for d in reversed(range(1,101)):
                        dd = cc * 2 ** d

                        if dd <= n:
                            remain = n - dd
                            print(f"\t\t(5x{b} x 3x{c} x 2x{d}) remain:{remain}")

                            # 割り切れた
                            if remain == 0:
                                return [0, b, c, d]

    for c in reversed(range(1,101)):
        cc = 3 ** c

        if cc <= n:
            remain = n - cc
            print(f"(3x{c}) remain:{remain}")

            # 割り切れた
            if remain == 0:
                return [0, 0, c, 0]

            # 余った数で続きをやる

            for d in reversed(range(1,101)):
                dd = cc * 2 ** d

                if dd <= n:
                    remain = n - dd
                    print(f"\t(3x{c} x 2x{d}) remain:{remain}")

                    # 割り切れた
                    if remain == 0:
                        return [0, 0, c, d]

    for d in reversed(range(1,101)):
        dd = 2 ** d

        if dd <= n:
            remain = n - dd
            print(f"(2x{d}) remain:{remain}")

            # 割り切れた
            if remain == 0:
                return [0, 0, 0, d]

print(f"Anser:{factorize(n)}")
```

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👆　愚直に書くと　こうか」  

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　ややこしいから　一般化しなくてよくない？」  

# n = 1～100 まで見てみよう

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👇　n を 1 から 100 まで入れてみようぜ？」  

```plaintext
N=1 Answer=None
N=2 Answer=[0, 0, 0, 1]
N=3 Answer=[0, 0, 1, 0]
N=4 Answer=[0, 0, 0, 2]
N=5 Answer=[0, 1, 0, 0]
N=6 Answer=[0, 0, 1, 1]
N=7 Answer=[1, 0, 0, 0]
N=8 Answer=[0, 0, 0, 3]
N=9 Answer=[0, 0, 2, 0]
N=10 Answer=None
N=11 Answer=None
N=12 Answer=[0, 0, 1, 2]
N=13 Answer=None
N=14 Answer=None
N=15 Answer=[0, 1, 1, 0]
N=16 Answer=[0, 0, 0, 4]
N=17 Answer=None
N=18 Answer=[0, 0, 2, 1]
N=19 Answer=None
N=20 Answer=None
N=21 Answer=None
N=22 Answer=None
N=23 Answer=None
N=24 Answer=[0, 0, 1, 3]
N=25 Answer=[0, 2, 0, 0]
N=26 Answer=None
N=27 Answer=[0, 0, 3, 0]
N=28 Answer=None
N=29 Answer=None
N=30 Answer=[0, 1, 1, 1]
N=31 Answer=None
N=32 Answer=[0, 0, 0, 5]
N=33 Answer=None
N=34 Answer=None
N=35 Answer=[1, 1, 0, 0]
N=36 Answer=[0, 0, 2, 2]
N=37 Answer=None
N=38 Answer=None
N=39 Answer=None
N=40 Answer=None
N=41 Answer=None
N=42 Answer=None
N=43 Answer=None
N=44 Answer=None
N=45 Answer=[0, 1, 2, 0]
N=46 Answer=None
N=47 Answer=None
N=48 Answer=[0, 0, 1, 4]
N=49 Answer=[2, 0, 0, 0]
N=50 Answer=None
N=51 Answer=None
N=52 Answer=None
N=53 Answer=None
N=54 Answer=[0, 0, 3, 1]
N=55 Answer=None
N=56 Answer=None
N=57 Answer=None
N=58 Answer=None
N=59 Answer=None
N=60 Answer=[0, 1, 1, 2]
N=61 Answer=None
N=62 Answer=None
N=63 Answer=None
N=64 Answer=[0, 0, 0, 6]
N=65 Answer=None
N=66 Answer=None
N=67 Answer=None
N=68 Answer=None
N=69 Answer=None
N=70 Answer=None
N=71 Answer=None
N=72 Answer=[0, 0, 2, 3]
N=73 Answer=None
N=74 Answer=None
N=75 Answer=[0, 2, 1, 0]
N=76 Answer=None
N=77 Answer=None
N=78 Answer=None
N=79 Answer=None
N=80 Answer=None
N=81 Answer=[0, 0, 4, 0]
N=82 Answer=None
N=83 Answer=None
N=84 Answer=None
N=85 Answer=None
N=86 Answer=None
N=87 Answer=None
N=88 Answer=None
N=89 Answer=None
N=90 Answer=[0, 1, 2, 1]
N=91 Answer=None
N=92 Answer=None
N=93 Answer=None
N=94 Answer=None
N=95 Answer=None
N=96 Answer=[0, 0, 1, 5]
N=97 Answer=None
N=98 Answer=None
N=99 Answer=None
N=100 Answer=None
```

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👆　20 は `5*2*2` だろ。ミスってんのかな？」  

![kifuwarabe-futsu.png](https://crieit.now.sh/upload_images/beaf94b260ae2602ca8cf7f5bbc769c261daf8686dbda.png)  
「　お父んのループ、３の倍数が０のケースを　表現できてないんだぜ」  

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　なるほど」  

# 0乗は1

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　0乗は1 だから、ループで 0 まで回せばいいんじゃないの？」  

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　それだぜ」  

```py
# 素因数分解の練習
#
# cd math/prime_factorization
# python step1.py

def factorize(n, debug=True):

    for a in reversed(range(0,101)):
        aa = 7 ** a

        # n 以下の小さな合成数 7a なら、とりあえず n から、それを引く
        if aa <= n:
            remain = n - aa

            if debug:
                print(f"(7x{a}) remain:{remain}")

            # 割り切れた
            if remain == 0:
                return [a, 0, 0, 0]

            # 余った数で続きをやる

            for b in reversed(range(0,101)):
                bb = aa * 5 ** b

                if bb <= n:
                    remain = n - bb

                    if debug:
                        print(f"\t(7x{a} x 5x{b}) remain:{remain}")

                    # 割り切れた
                    if remain == 0:
                        return [a, b, 0, 0]

                    # 余った数で続きをやる

                    for c in reversed(range(0,101)):
                        cc = bb * 3 ** c

                        if cc <= n:
                            remain = n - cc

                            if debug:
                                print(f"\t\t(7x{a} x 5x{b} x 3x{c}) remain:{remain}")

                            # 割り切れた
                            if remain == 0:
                                return [a, b, c, 0]

                            # 余った数で続きをやる

                            for d in reversed(range(0,101)):
                                dd = cc * 2 ** d

                                if dd <= n:
                                    remain = n - dd

                                    if debug:
                                        print(f"\t\t\t(7x{a} x 5x{b} x 3x{c} x 2x{d}) remain:{remain}")

                                    # 割り切れた
                                    if remain == 0:
                                        return [a, b, c, d]


if __name__ == "__main__":
    
    print("""\
ある正の整数 n があるとする。
とりあえず n は 1～100 ぐらいを考えておく。

n を　2, 3, 5, 7　の素数で素因数分解する。

答えがいくつかあるとき、大きな数を多く使ったものを　１つ　選ぶことにする。
""")

    print("Please input number:")
    n = int(input())

    print(f"Anser:{factorize(n)}")
```

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👆　コードが一気に短くなったな」  

# 次の問い

```plaintext
N=1 Answer=[0, 0, 0, 0]
N=2 Answer=[0, 0, 0, 1]
N=3 Answer=[0, 0, 1, 0]
N=4 Answer=[0, 0, 0, 2]
N=5 Answer=[0, 1, 0, 0]
N=6 Answer=[0, 0, 1, 1]
N=7 Answer=[1, 0, 0, 0]
N=8 Answer=[0, 0, 0, 3]
N=9 Answer=[0, 0, 2, 0]
N=10 Answer=[0, 1, 0, 1]
N=11 Answer=None
N=12 Answer=[0, 0, 1, 2]
N=13 Answer=None
N=14 Answer=[1, 0, 0, 1]
N=15 Answer=[0, 1, 1, 0]
N=16 Answer=[0, 0, 0, 4]
N=17 Answer=None
N=18 Answer=[0, 0, 2, 1]
N=19 Answer=None
N=20 Answer=[0, 1, 0, 2]
N=21 Answer=[1, 0, 1, 0]
N=22 Answer=None
N=23 Answer=None
N=24 Answer=[0, 0, 1, 3]
N=25 Answer=[0, 2, 0, 0]
N=26 Answer=None
N=27 Answer=[0, 0, 3, 0]
N=28 Answer=[1, 0, 0, 2]
N=29 Answer=None
N=30 Answer=[0, 1, 1, 1]
N=31 Answer=None
N=32 Answer=[0, 0, 0, 5]
N=33 Answer=None
N=34 Answer=None
N=35 Answer=[1, 1, 0, 0]
N=36 Answer=[0, 0, 2, 2]
N=37 Answer=None
N=38 Answer=None
N=39 Answer=None
N=40 Answer=[0, 1, 0, 3]
N=41 Answer=None
N=42 Answer=[1, 0, 1, 1]
N=43 Answer=None
N=44 Answer=None
N=45 Answer=[0, 1, 2, 0]
N=46 Answer=None
N=47 Answer=None
N=48 Answer=[0, 0, 1, 4]
N=49 Answer=[2, 0, 0, 0]
N=50 Answer=[0, 2, 0, 1]
N=51 Answer=None
N=52 Answer=None
N=53 Answer=None
N=54 Answer=[0, 0, 3, 1]
N=55 Answer=None
N=56 Answer=[1, 0, 0, 3]
N=57 Answer=None
N=58 Answer=None
N=59 Answer=None
N=60 Answer=[0, 1, 1, 2]
N=61 Answer=None
N=62 Answer=None
N=63 Answer=[1, 0, 2, 0]
N=64 Answer=[0, 0, 0, 6]
N=65 Answer=None
N=66 Answer=None
N=67 Answer=None
N=68 Answer=None
N=69 Answer=None
N=70 Answer=[1, 1, 0, 1]
N=71 Answer=None
N=72 Answer=[0, 0, 2, 3]
N=73 Answer=None
N=74 Answer=None
N=75 Answer=[0, 2, 1, 0]
N=76 Answer=None
N=77 Answer=None
N=78 Answer=None
N=79 Answer=None
N=80 Answer=[0, 1, 0, 4]
N=81 Answer=[0, 0, 4, 0]
N=82 Answer=None
N=83 Answer=None
N=84 Answer=[1, 0, 1, 2]
N=85 Answer=None
N=86 Answer=None
N=87 Answer=None
N=88 Answer=None
N=89 Answer=None
N=90 Answer=[0, 1, 2, 1]
N=91 Answer=None
N=92 Answer=None
N=93 Answer=None
N=94 Answer=None
N=95 Answer=None
N=96 Answer=[0, 0, 1, 5]
N=97 Answer=None
N=98 Answer=[2, 0, 0, 1]
N=99 Answer=None
N=100 Answer=[0, 2, 0, 2]
```

![ramen-tabero-futsu2.png](https://crieit.now.sh/upload_images/d27ea8dcfad541918d9094b9aed83e7d61daf8532bbbe.png)  
「　👆　上図を見ると、 `[0, 0, 0, 5]`　は　`[0, 1, 1, 1]`　より　n が ２個分強いんだが、  
素因数分解を使わずに  
`[0, 0, 0, 5]`　は　`[0, 1, 1, 1]`　より　n が ２個分強いということを  
計算する方法って　ある？」  

![ohkina-hiyoko-futsu2.png](https://crieit.now.sh/upload_images/96fb09724c3ce40ee0861a0fd1da563d61daf8a09d9bc.png)  
「　無いということにして　早く楽したいわね……」  


.